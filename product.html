<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kasturi Divine • Shop</title>
  <style>
    :root{
      --brand:#5b3a1a; /* kasturi brown */
      --accent:#c8a46a;
      --bg:#faf8f4;
      --text:#2b2b2b;
      --muted:#777;
      --card:#ffffff;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg); color:var(--text);
    }
    header{
      position:sticky; top:0; z-index:10;
      background:var(--card); border-bottom:1px solid #eee;
    }
    .wrap{max-width:1100px; margin:auto; padding:16px}
    .brand{
      display:flex; align-items:center; gap:12px; font-weight:700; letter-spacing:.3px;
      color:var(--brand)
    }
    .brand img{width:40px; height:40px; object-fit:contain}
    .toolbar{display:flex; gap:8px; align-items:center; justify-content:space-between}
    .search{
      display:flex; gap:8px; flex:1; max-width:520px; margin:0 16px;
      background:#f4efe6; border:1px solid #eadfcd; border-radius:999px; padding:8px 12px;
    }
    .search input{flex:1; border:0; background:transparent; outline:0; font-size:15px}
    .btn{
      cursor:pointer; border:1px solid var(--accent); color:#fff; background:var(--accent);
      padding:10px 14px; border-radius:999px; font-weight:600; transition:.2s;
    }
    .btn.ghost{background:#fff; color:var(--brand); border-color:#e6d8bf}
    .btn:hover{filter:brightness(0.95)}
    main .heading{padding:18px 0 6px; color:var(--brand); font-size:20px; font-weight:700}
    .grid{
      display:grid; gap:16px; grid-template-columns:repeat( auto-fill, minmax(220px,1fr) );
    }
    .card{
      background:var(--card); border:1px solid #eee; border-radius:16px; overflow:hidden;
      display:flex; flex-direction:column; box-shadow:0 2px 10px rgba(0,0,0,.04);
    }
    .card img{width:100%; height:200px; object-fit:cover; background:#f2f2f2}
    .card .pad{padding:12px}
    .title{font-weight:700}
    .price{color:var(--brand); font-weight:800; margin:6px 0 2px}
    .mrp{color:var(--muted); text-decoration:line-through; font-size:13px; margin-left:6px}
    .ship{font-size:12px; color:var(--muted)}
    .card .actions{display:flex; gap:8px; margin-top:10px}
    .tag{font-size:12px; background:#fff5e6; border:1px dashed #ffd9a1; color:#8a5b1c;
         padding:3px 8px; border-radius:999px; display:inline-block; margin-top:6px}
    /* drawer (product detail + checkout) */
    dialog{
      border:0; width:min(920px,95vw); border-radius:20px; padding:0; overflow:hidden;
      box-shadow:0 20px 60px rgba(0,0,0,.18);
    }
    dialog::backdrop{background:rgba(0,0,0,.4)}
    .drawer{display:grid; grid-template-columns: 1fr 1fr;}
    .drawer .left{background:#f8f6f1}
    .drawer .left img{width:100%; height:100%; object-fit:cover}
    .drawer .right{padding:20px}
    .right h2{margin:0 0 6px}
    .muted{color:var(--muted); font-size:14px}
    .qty{display:flex; gap:8px; align-items:center; margin:10px 0}
    .qty input{width:70px; padding:8px; border-radius:10px; border:1px solid #ddd}
    form .row{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    form input, form textarea, form select{
      width:100%; padding:10px; border-radius:12px; border:1px solid #ddd; font-size:15px;
      background:#fff
    }
    form textarea{min-height:90px; resize:vertical}
    .paybox{display:flex; gap:10px; flex-wrap:wrap; margin:6px 0 12px}
    .payopt{border:1px solid #e6d8bf; padding:8px 12px; border-radius:12px; cursor:pointer}
    .note{font-size:12px; color:var(--muted)}
    footer{padding:24px 0; text-align:center; color:#8c6b3d; font-size:13px}
    @media (max-width:780px){
      .drawer{grid-template-columns:1fr}
      .search{margin:10px 0}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap toolbar">
      <div class="brand">
        <img src="LOGO.png" alt="Kasturi Divine" onerror="this.style.display='none'">
        <span>KASTURI DIVINE • Shop</span>
      </div>
      <div class="search">
        <input id="q" type="search" placeholder="Search remedies, yantra, crystals…" />
        <button class="btn ghost" onclick="clearSearch()">Clear</button>
      </div>
      <div>
        <a class="btn ghost" href="index.html">⬅ Back to Home</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="heading">Featured Products</div>
    <div id="grid" class="grid"></div>
  </main>

  <footer>
    Secure checkout • COD/UPI available • Delivery all India
  </footer>

  <!-- Product Drawer -->
  <dialog id="drawer">
    <div class="drawer">
      <div class="left">
        <img id="dImg" alt="">
      </div>
      <div class="right">
        <button class="btn ghost" style="float:right" onclick="closeDrawer()">✕ Close</button>
        <h2 id="dTitle"></h2>
        <div class="muted" id="dCat"></div>
        <div class="price">
          ₹<span id="dPrice"></span>
          <span class="mrp" id="dMrp"></span>
        </div>
        <div class="tag" id="dTag"></div>

        <p id="dDesc" class="muted" style="margin-top:10px"></p>

        <div class="qty">
          Qty:
          <input id="qty" type="number" min="1" value="1">
        </div>

        <form id="orderForm" onsubmit="submitOrder(event)">
          <div class="row">
            <input required name="name" placeholder="Full name" />
            <input required name="phone" placeholder="Phone" pattern="[0-9]{10,13}" />
          </div>
          <textarea required name="address" placeholder="Full address with pincode"></textarea>
          <div class="row">
            <input name="city" placeholder="City" />
            <input name="state" placeholder="State" />
          </div>
          <select name="payment" required>
            <option value="" disabled selected>Choose Payment Method</option>
            <option>UPI</option>
            <option>Cash on Delivery (COD)</option>
          </select>
          <div class="paybox">
            <span class="payopt">Free delivery over ₹999</span>
            <span class="payopt">7‑day replacement</span>
            <span class="payopt">Secure payment</span>
          </div>
          <div class="note">On selecting UPI, order page will show UPI QR/details. For COD, pay to courier.</div>
          <div style="display:flex; gap:10px; margin-top:10px">
            <button type="submit" class="btn">Buy Now</button>
            <button type="button" class="btn ghost" onclick="closeDrawer()">Cancel</button>
          </div>
          <input type="hidden" name="productId" id="productId">
          <input type="hidden" name="productTitle" id="productTitle">
          <input type="hidden" name="productPrice" id="productPrice">
        </form>
      </div>
    </div>
  </dialog>

  <!-- Lightweight “order placed” sheet -->
  <dialog id="thankyou">
    <div style="padding:24px; max-width:520px">
      <h3 style="margin:0 0 6px; color:var(--brand)">Order placed ✔</h3>
      <p class="muted">Thank you! We’ve captured your details. For UPI, pay to the UPI ID/QR below and share screenshot on WhatsApp.</p>
      <div id="upiBox" style="border:1px dashed #e6d8bf; padding:12px; border-radius:12px; background:#fffaf0; margin:12px 0">
        <b>UPI ID:</b> <span id="upiId">wardhman@upi</span><br>
        <b>Amount:</b> ₹<span id="amt"></span><br>
        <div class="note">You can place COD if you prefer not to prepay.</div>
      </div>
      <a class="btn" href="https://wa.me/918878211880" target="_blank" rel="noopener">Send details on WhatsApp</a>
      <button class="btn ghost" onclick="document.getElementById('thankyou').close()">Close</button>
    </div>
  </dialog>

  <script>
    // ----- Sample catalog (edit as per your products) -----
    const PRODUCTS = [
      {
        id:"pyrite-bracelet",
        title:"Pyrite Bracelet – Money Magnet",
        price:699, mrp:999,
        img:"SN.png", // replace with your image
        cat:"Crystal • Wealth",
        tag:"Best Seller",
        desc:"Energized pyrite bracelet for prosperity and confidence. Standard size with strong elastic thread."
      },
      {
        id:"rudraksha-yantra",
        title:"Shree Yantra (Brass) – 3 inch",
        price:1199, mrp:1499,
        img:"public/images/yantra.jpg", // optional different path
        cat:"Yantra • Prosperity",
        tag:"Premium",
        desc:"Beautifully crafted brass Shree Yantra for home/office temple. Blessings for abundance."
      },
      {
        id:"vastu-salt",
        title:"Vastu Himalayan Salt – 1kg",
        price:249, mrp:349,
        img:"public/images/salt.jpg",
        cat:"Remedy • Vastu",
        tag:"Daily Use",
        desc:"Use for space cleansing and negative energy removal. Easy and effective home remedy."
      },
      {
        id:"navgrah-havan",
        title:"Navgrah Havan Kit",
        price:1599, mrp:1999,
        img:"public/images/havan.jpg",
        cat:"Pooja • Kit",
        tag:"Combo",
        desc:"Complete kit for Navgrah Havan with instructions. Suitable for beginners."
      }
    ];

    // ----- Render grid -----
    const grid = document.getElementById('grid');
    function render(list){
      grid.innerHTML = "";
      list.forEach(p=>{
        const el = document.createElement('div');
        el.className = 'card';
        el.innerHTML = `
          <img src="${p.img}" alt="${p.title}" onerror="this.src='https://via.placeholder.com/640x400?text=Product'">
          <div class="pad">
            <div class="title">${p.title}</div>
            <div class="price">₹${p.price} <span class="mrp">₹${p.mrp}</span></div>
            <div class="ship">Fast delivery across India</div>
            <span class="tag">${p.tag}</span>
            <div class="actions">
              <button class="btn" onclick="openDrawer('${p.id}')">Buy</button>
              <button class="btn ghost" onclick="openDrawer('${p.id}')">View Details</button>
            </div>
          </div>
        `;
        grid.appendChild(el);
      });
    }
    render(PRODUCTS);

    // ----- Search -----
    const q = document.getElementById('q');
    q.addEventListener('input', ()=>{
      const term = q.value.toLowerCase().trim();
      const filtered = PRODUCTS.filter(p =>
        p.title.toLowerCase().includes(term) ||
        p.cat.toLowerCase().includes(term) ||
        p.tag.toLowerCase().includes(term)
      );
      render(filtered);
    });
    function clearSearch(){ q.value=""; render(PRODUCTS); }

    // ----- Drawer (details + checkout) -----
    const drawer = document.getElementById('drawer');
    function openDrawer(id){
      const p = PRODUCTS.find(x=>x.id===id); if(!p) return;
      document.getElementById('dImg').src = p.img;
      document.getElementById('dTitle').textContent = p.title;
      document.getElementById('dCat').textContent = p.cat;
      document.getElementById('dPrice').textContent = p.price;
      document.getElementById('dMrp').textContent = '₹'+p.mrp;
      document.getElementById('dTag').textContent = p.tag;
      document.getElementById('dDesc').textContent = p.desc;
      document.getElementById('productId').value = p.id;
      document.getElementById('productTitle').value = p.title;
      document.getElementById('productPrice').value = p.price;
      document.getElementById('qty').value = 1;
      drawer.showModal();
      history.replaceState(null, "", `?id=${encodeURIComponent(p.id)}`);
    }
    function closeDrawer(){
      drawer.close();
      history.replaceState(null, "", location.pathname);
    }
    // Open direct by URL ?id=
    const params = new URLSearchParams(location.search);
    if(params.get('id')) openDrawer(params.get('id'));

    // ----- Form submit -----
    function submitOrder(e){
      e.preventDefault();
      const fd = new FormData(e.target);
      const qty = parseInt(document.getElementById('qty').value||'1',10);
      const price = parseInt(fd.get('productPrice'),10);
      const amount = price*qty;
      // show thank you + UPI block if selected
      document.getElementById('amt').textContent = amount;
      const pay = fd.get('payment')||'';
      document.getElementById('upiBox').style.display = pay.includes('UPI') ? 'block' : 'none';
      document.getElementById('thankyou').showModal();
      // Basic log in console (you can later post to Google Sheet / CountAPI)
      console.log('ORDER', Object.fromEntries(fd.entries()), {qty, amount});
      // Reset only minimal fields
      // e.target.reset(); // optional
    }

    // Escape to close dialogs
    document.addEventListener('keydown', (ev)=>{
      if(ev.key==='Escape'){
        if(drawer.open) drawer.close();
        if(thankyou.open) thankyou.close();
      }
    });
  </script>
</body>
</html>
